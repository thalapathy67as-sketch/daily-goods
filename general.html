<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CinemaHub | Stream Premium Movies</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Poppins', sans-serif; }
        body { background: #0a0e27; color: #fff; }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .hero {
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.8)), url('https://images.unsplash.com/photo-1574375927938-d5a98e8ffe85?auto=format&fit=crop&q=80&w=1920');
            background-size: cover;
            background-position: center;
            height: 500px;
        }
        
        .movie-card {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            aspect-ratio: 2/3;
            background: #1a1a2e;
        }
        
        .movie-card:hover {
            transform: scale(1.08) translateY(-8px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
        }
        
        .movie-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .movie-card:hover img {
            filter: brightness(1.2);
        }
        
        .movie-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.95), rgba(0,0,0,0.7));
            padding: 12px;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }
        
        .movie-card:hover .movie-overlay {
            transform: translateY(0);
        }
        
        .play-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            border: none;
            color: white;
        }
        
        .movie-card:hover .play-btn {
            opacity: 1;
        }
        
        .play-btn:hover {
            transform: translate(-50%, -50%) scale(1.15);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.8);
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: #1a1a2e;
            border-radius: 16px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid #333;
        }
        
        .trailer-modal-content {
            background: transparent;
            max-width: 900px;
            position: relative;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            background: #000;
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 12px;
        }
        
        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
        }
        
        .close-btn:hover {
            background: rgba(0,0,0,0.9);
            transform: scale(1.1);
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }
        
        .btn-secondary {
            border: 2px solid #667eea;
            color: #667eea;
            background: transparent;
        }
        
        .btn-secondary:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.05);
        }
        
        .btn-danger {
            background: #dc2626;
            color: white;
        }
        
        .btn-danger:hover {
            background: #b91c1c;
        }
        
        .category-btn {
            padding: 8px 20px;
            border-radius: 20px;
            border: 2px solid #333;
            background: transparent;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 600;
        }
        
        .category-btn:hover,
        .category-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
        }
        
        .search-input {
            width: 100%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 25px;
            padding: 10px 20px;
            color: #fff;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.15);
        }
        
        .search-input::placeholder {
            color: #999;
        }
        
        .rating { color: #ffd700; font-size: 14px; }
        
        .watchlist-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #dc2626;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .notification {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #10b981;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: slideIn 0.3s ease;
            z-index: 999;
        }
        
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .no-poster {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-size: 40px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="sticky top-0 z-40 bg-black/80 backdrop-blur-md border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="text-3xl">üé¨</div>
                <span class="text-2xl font-bold gradient-text">CinemaHub</span>
            </div>
            
            <div class="hidden md:block">
                <input type="text" id="searchInput" placeholder="Search movies..." class="search-input">
            </div>
            
            <div class="flex items-center gap-4">
                <button id="watchlistBtn" onclick="toggleWatchlist()" class="relative px-4 py-2 rounded-lg hover:bg-gray-800 transition font-semibold">
                    ‚ù§Ô∏è Watchlist
                    <span id="watchlistBadge" class="watchlist-badge hidden">0</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero relative flex items-end p-8">
        <div class="max-w-xl">
            <h1 id="heroTitle" class="text-5xl font-bold mb-4">Stream Premium Movies</h1>
            <p id="heroDesc" class="text-gray-300 mb-6 line-clamp-3">Watch thousands of movies instantly</p>
            <div class="flex gap-4">
                <button id="heroPlayBtn" onclick="playTrailer()" class="btn btn-primary">
                    ‚ñ∂ Watch Now
                </button>
                <button onclick="addToWatchlist()" class="btn btn-secondary">
                    + Watchlist
                </button>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-12">
        <!-- Categories -->
        <div class="mb-12 flex gap-3 overflow-x-auto pb-4">
            <button onclick="filterGenre('all')" class="category-btn active">All</button>
            <button onclick="filterGenre('action')" class="category-btn">Action</button>
            <button onclick="filterGenre('comedy')" class="category-btn">Comedy</button>
            <button onclick="filterGenre('drama')" class="category-btn">Drama</button>
            <button onclick="filterGenre('horror')" class="category-btn">Horror</button>
            <button onclick="filterGenre('scifi')" class="category-btn">Sci-Fi</button>
            <button onclick="filterGenre('romance')" class="category-btn">Romance</button>
        </div>

        <!-- Trending Section -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold mb-6">üî• Trending Now</h2>
            <div id="trendingMovies" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                <!-- Movies load here -->
            </div>
        </section>

        <!-- Popular Section -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold mb-6">‚≠ê Most Popular</h2>
            <div id="popularMovies" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                <!-- Movies load here -->
            </div>
        </section>

        <!-- Top Rated Section -->
        <section>
            <h2 class="text-3xl font-bold mb-6">üëë Top Rated</h2>
            <div id="topRatedMovies" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                <!-- Movies load here -->
            </div>
        </section>
    </main>

    <!-- Movie Details Modal -->
    <div id="movieModal" class="modal">
        <button class="close-btn" onclick="closeModal()">‚úï</button>
        <div class="modal-content">
            <img id="modalPoster" src="" alt="" class="w-full h-80 object-cover rounded-t-lg">
            <div class="p-8">
                <h2 id="modalTitle" class="text-3xl font-bold mb-2"></h2>
                <div class="flex gap-4 mb-4">
                    <span id="modalRating" class="rating"></span>
                    <span id="modalYear" class="text-gray-400"></span>
                </div>
                <p id="modalDesc" class="text-gray-300 mb-6 leading-relaxed"></p>
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <p class="text-gray-400 text-sm">Rating</p>
                        <p id="modalIMDB" class="text-2xl font-bold">8.5/10</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm">Genre</p>
                        <p id="modalGenre" class="text-lg font-semibold">Action</p>
                    </div>
                </div>
                <div class="flex gap-4">
                    <button onclick="playTrailer()" class="flex-1 btn btn-primary">‚ñ∂ Watch Trailer</button>
                    <button id="modalWatchlistBtn" onclick="toggleModalWatchlist()" class="flex-1 btn btn-secondary">+ Watchlist</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Trailer Modal -->
    <div id="trailerModal" class="modal">
        <button class="close-btn" onclick="closeTrailer()">‚úï</button>
        <div class="trailer-modal-content">
            <div class="video-container">
                <iframe id="trailerIframe" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
        </div>
    </div>

    <!-- Watchlist Modal -->
    <div id="watchlistModal" class="modal">
        <button class="close-btn" onclick="toggleWatchlist()">‚úï</button>
        <div class="modal-content">
            <div class="p-8">
                <h2 class="text-3xl font-bold mb-6">‚ù§Ô∏è My Watchlist</h2>
                <div id="watchlistItems" class="space-y-4">
                    <p class="text-gray-400 text-center py-8">Your watchlist is empty</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification hidden"></div>

    <script>
        // Complete Movie Database with trailers
        const movies = [
            {
                id: 1,
                title: "The Shawshank Redemption",
                overview: "Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.",
                poster: "https://images.unsplash.com/photo-1489599849228-bed96d3a3c4d?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/6hB3ŸàÿØQfLg",
                rating: 9.3,
                year: 1994,
                genre: "drama",
                categories: ["drama"]
            },
            {
                id: 2,
                title: "The Godfather",
                overview: "The aging patriarch of an organized crime dynasty transfers control to his reluctant youngest son.",
                poster: "https://images.unsplash.com/photo-1485846234645-a62644f84728?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/sY1S34973d4",
                rating: 9.2,
                year: 1972,
                genre: "drama",
                categories: ["drama"]
            },
            {
                id: 3,
                title: "The Dark Knight",
                overview: "When the Joker wreaks havoc on Gotham, Batman must accept one of the greatest tests to fight injustice.",
                poster: "https://images.unsplash.com/photo-1543722530-d2c3201371e7?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/EXeTwQWrcwY",
                rating: 9.0,
                year: 2008,
                genre: "action",
                categories: ["action"]
            },
            {
                id: 4,
                title: "Inception",
                overview: "A thief who steals corporate secrets through dream-sharing technology is given the inverse task of planting an idea.",
                poster: "https://images.unsplash.com/photo-1512070679280-1a45f9c16c78?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/YoHD_XwrzKc",
                rating: 8.8,
                year: 2010,
                genre: "scifi",
                categories: ["scifi"]
            },
            {
                id: 5,
                title: "Pulp Fiction",
                overview: "The lives of two mob hitmen, a boxer, a gangster's wife intertwine in four tales of violence.",
                poster: "https://images.unsplash.com/photo-1548010894-a3a4dc0c8fe6?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/s7EdQ4FqJDE",
                rating: 8.9,
                year: 1994,
                genre: "drama",
                categories: ["drama"]
            },
            {
                id: 6,
                title: "Forrest Gump",
                overview: "The presidencies of Kennedy and Johnson unfold from the perspective of an Alabama man with an unusual destiny.",
                poster: "https://images.unsplash.com/photo-1574235211450-eed266df24cd?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/bLvqoByUGDc",
                rating: 8.8,
                year: 1994,
                genre: "drama",
                categories: ["drama", "romance"]
            },
            {
                id: 7,
                title: "Interstellar",
                overview: "A team of explorers travel through a wormhole in space to ensure humanity's survival.",
                poster: "https://images.unsplash.com/photo-1536440936694-6c676bccc92e?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/zSp-3fq52EI",
                rating: 8.7,
                year: 2014,
                genre: "scifi",
                categories: ["scifi"]
            },
            {
                id: 8,
                title: "The Matrix",
                overview: "A computer hacker learns about the true nature of his reality and his role in the war against its controllers.",
                poster: "https://images.unsplash.com/photo-1535016066054-ad025b65f5a3?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/vKQi3bBA1y8",
                rating: 8.7,
                year: 1999,
                genre: "scifi",
                categories: ["scifi", "action"]
            },
            {
                id: 9,
                title: "Titanic",
                overview: "A seventeen-year-old aristocrat falls in love with a kind but poor artist aboard the ill-fated R.M.S. Titanic.",
                poster: "https://images.unsplash.com/photo-1561988703-137c0343e2fb?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/CHmeqaUlXfk",
                rating: 7.8,
                year: 1997,
                genre: "romance",
                categories: ["romance", "drama"]
            },
            {
                id: 10,
                title: "Joker",
                overview: "In Gotham City, struggling comedian Arthur Fleck is disregarded by society and embarks on a downward spiral.",
                poster: "https://images.unsplash.com/photo-1618945824727-92b8c258401e?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/t433PEQvMGs",
                rating: 8.4,
                year: 2019,
                genre: "drama",
                categories: ["drama"]
            },
            {
                id: 11,
                title: "Avengers Endgame",
                overview: "After the devastating events, the Avengers assemble once more to reverse Thanos' actions.",
                poster: "https://images.unsplash.com/photo-1578874691223-64558c0e33ad?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/TcMBFSGVi1c",
                rating: 8.4,
                year: 2019,
                genre: "action",
                categories: ["action"]
            },
            {
                id: 12,
                title: "Dune",
                overview: "Paul Atreides travels to the dangerous planet Arrakis to ensure the future of his family and people.",
                poster: "https://images.unsplash.com/photo-1597990810691-e39a982f0dfa?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/n9xhJsAgZmM",
                rating: 8.0,
                year: 2021,
                genre: "scifi",
                categories: ["scifi"]
            },
            {
                id: 13,
                title: "The Conjuring",
                overview: "Paranormal investigators work to help a family terrorized by a dark presence in their farmhouse.",
                poster: "https://images.unsplash.com/photo-1513741539140-09461f1aa8a8?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/k10ETZ41b5o",
                rating: 7.5,
                year: 2013,
                genre: "horror",
                categories: ["horror"]
            },
            {
                id: 14,
                title: "Deadpool",
                overview: "A former assassin with accelerated healing becomes a merc with a mouth seeking revenge.",
                poster: "https://images.unsplash.com/photo-1505686994434-e3cc5abf1330?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/ONHd4o9yWgI",
                rating: 8.0,
                year: 2016,
                genre: "action",
                categories: ["action", "comedy"]
            },
            {
                id: 15,
                title: "The Hangover",
                overview: "Three buddies wake up from a bachelor party in Las Vegas with no memory of the night.",
                poster: "https://images.unsplash.com/photo-1552891219-acff387b4e4e?auto=format&fit=crop&q=80&w=500",
                trailer: "https://www.youtube.com/embed/tpOj4fI-sXE",
                rating: 7.7,
                year: 2009,
                genre: "comedy",
                categories: ["comedy"]
            }
        ];

        let watchlist = JSON.parse(localStorage.getItem('watchlist')) || [];
        let currentGenre = 'all';
        let currentMovieId = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            displayMovies(movies, 'trendingMovies');
            displayMovies(movies.slice(0, 10), 'popularMovies');
            displayMovies(movies.slice(5, 15), 'topRatedMovies');
            updateWatchlistBadge();
            setupSearch();
            
            document.getElementById('heroTitle').textContent = movies[0].title;
            document.getElementById('heroDesc').textContent = movies[0].overview;
        });

        // Display movies
        function displayMovies(moviesToDisplay, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = moviesToDisplay.map(movie => `
                <div class="movie-card" onclick="openMovieDetail(${movie.id})">
                    <img src="${movie.poster}" alt="${movie.title}" onerror="this.parentElement.innerHTML='<div class=\"no-poster\">üé¨</div>'">
                    <button class="play-btn" onclick="event.stopPropagation(); playTrailer(${movie.id})">‚ñ∂</button>
                    <div class="movie-overlay">
                        <h3 class="font-bold text-sm line-clamp-2">${movie.title}</h3>
                        <div class="flex gap-2 mt-2 text-xs text-gray-300">
                            <span class="rating">‚≠ê ${movie.rating}</span>
                            <span>${movie.year}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Open movie detail
        function openMovieDetail(movieId) {
            const movie = movies.find(m => m.id === movieId);
            if (!movie) return;

            currentMovieId = movieId;
            
            document.getElementById('modalPoster').src = movie.poster;
            document.getElementById('modalTitle').textContent = movie.title;
            document.getElementById('modalDesc').textContent = movie.overview;
            document.getElementById('modalYear').textContent = movie.year;
            document.getElementById('modalIMDB').textContent = movie.rating.toFixed(1) + '/10';
            document.getElementById('modalGenre').textContent = movie.categories.join(', ') || 'N/A';
            
            const stars = Math.round(movie.rating / 2);
            document.getElementById('modalRating').innerHTML = '‚≠ê'.repeat(Math.min(stars, 5)) + '‚òÜ'.repeat(Math.max(0, 5 - stars));
            
            const inWatchlist = watchlist.includes(movieId);
            const btn = document.getElementById('modalWatchlistBtn');
            if (inWatchlist) {
                btn.textContent = '‚úì In Watchlist';
                btn.classList.add('btn-danger');
                btn.classList.remove('btn-secondary');
            } else {
                btn.textContent = '+ Watchlist';
                btn.classList.remove('btn-danger');
                btn.classList.add('btn-secondary');
            }
            
            document.getElementById('movieModal').classList.add('active');
        }

        // Close modal
        function closeModal() {
            document.getElementById('movieModal').classList.remove('active');
            currentMovieId = null;
        }

        // Play trailer
        function playTrailer(movieId = null) {
            const id = movieId || currentMovieId;
            const movie = movies.find(m => m.id === id);
            if (!movie) return;
            
            document.getElementById('trailerIframe').src = movie.trailer + '?autoplay=1';
            document.getElementById('trailerModal').classList.add('active');
        }

        // Close trailer
        function closeTrailer() {
            document.getElementById('trailerIframe').src = '';
            document.getElementById('trailerModal').classList.remove('active');
        }

        // Toggle watchlist modal
        function toggleWatchlist() {
            const modal = document.getElementById('watchlistModal');
            if (modal.classList.contains('active')) {
                modal.classList.remove('active');
            } else {
                displayWatchlist();
                modal.classList.add('active');
            }
        }

        // Display watchlist
        function displayWatchlist() {
            const container = document.getElementById('watchlistItems');
            
            if (watchlist.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-8">Your watchlist is empty. Add movies now!</p>';
                return;
            }
            
            const watchlistMovies = movies.filter(m => watchlist.includes(m.id));
            container.innerHTML = watchlistMovies.map(movie => `
                <div class="flex gap-4 p-4 bg-gray-800 rounded-lg">
                    <img src="${movie.poster}" alt="${movie.title}" class="w-20 h-32 object-cover rounded">
                    <div class="flex-1">
                        <h3 class="font-bold text-lg">${movie.title}</h3>
                        <p class="text-gray-400 text-sm mb-2">${movie.year}</p>
                        <p class="text-gray-300 text-sm line-clamp-2">${movie.overview}</p>
                        <div class="flex gap-2 mt-3">
                            <button onclick="playTrailer(${movie.id})" class="btn btn-primary">‚ñ∂ Trailer</button>
                            <button onclick="removeFromWatchlist(${movie.id})" class="btn btn-danger">Remove</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Add to watchlist
        function addToWatchlist(movieId = null) {
            const id = movieId || currentMovieId;
            if (!id) return;
            
            if (!watchlist.includes(id)) {
                watchlist.push(id);
                localStorage.setItem('watchlist', JSON.stringify(watchlist));
                updateWatchlistBadge();
                notify('Added to watchlist!');
                
                if (currentMovieId === id) {
                    const btn = document.getElementById('modalWatchlistBtn');
                    if (btn) {
                        btn.textContent = '‚úì In Watchlist';
                        btn.classList.add('btn-danger');
                        btn.classList.remove('btn-secondary');
                    }
                }
            }
        }

        // Toggle modal watchlist
        function toggleModalWatchlist() {
            if (watchlist.includes(currentMovieId)) {
                removeFromWatchlist(currentMovieId);
            } else {
                addToWatchlist(currentMovieId);
            }
        }

        // Remove from watchlist
        function removeFromWatchlist(movieId) {
            watchlist = watchlist.filter(id => id !== movieId);
            localStorage.setItem('watchlist', JSON.stringify(watchlist));
            updateWatchlistBadge();
            notify('Removed from watchlist');
            displayWatchlist();
            
            if (currentMovieId === movieId) {
                const btn = document.getElementById('modalWatchlistBtn');
                if (btn) {
                    btn.textContent = '+ Watchlist';
                    btn.classList.remove('btn-danger');
                    btn.classList.add('btn-secondary');
                }
            }
        }

        // Update watchlist badge
        function updateWatchlistBadge() {
            const badge = document.getElementById('watchlistBadge');
            if (watchlist.length > 0) {
                badge.textContent = watchlist.length;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // Filter by genre
        function filterGenre(genre) {
            currentGenre = genre;
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (genre === 'all') {
                displayMovies(movies, 'trendingMovies');
                displayMovies(movies.slice(0, 10), 'popularMovies');
                displayMovies(movies.slice(5, 15), 'topRatedMovies');
            } else {
                const filtered = movies.filter(m => m.categories.includes(genre));
                displayMovies(filtered, 'trendingMovies');
                document.getElementById('popularMovies').innerHTML = '';
                document.getElementById('topRatedMovies').innerHTML = '';
            }
        }

        // Search
        function setupSearch() {
            const input = document.getElementById('searchInput');
            input.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                if (query.length < 1) {
                    displayMovies(movies, 'trendingMovies');
                    document.getElementById('popularMovies').innerHTML = '';
                    document.getElementById('topRatedMovies').innerHTML = '';
                    return;
                }
                
                const results = movies.filter(m => m.title.toLowerCase().includes(query));
                displayMovies(results, 'trendingMovies');
                document.getElementById('popularMovies').innerHTML = '';
                document.getElementById('topRatedMovies').innerHTML = '';
            });
        }

        // Notification
        function notify(message) {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.classList.remove('hidden');
            setTimeout(() => {
                notif.classList.add('hidden');
            }, 2000);
        }

        // Close modals on background click
        document.addEventListener('click', (e) => {
            if (e.target.id === 'movieModal') closeModal();
            if (e.target.id === 'trailerModal') closeTrailer();
            if (e.target.id === 'watchlistModal') toggleWatchlist();
        });
    </script>
</body>
</html>
