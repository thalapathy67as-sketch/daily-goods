<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CinemaHub | Stream Premium Movies</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Poppins', sans-serif; }
        body { background: #0f0f0f; color: #fff; }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero {
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.7)), 
                        url('https://images.unsplash.com/photo-1574375927938-d5a98e8ffe85?auto=format&fit=crop&q=80&w=1920');
            background-size: cover;
            background-position: center;
            height: 500px;
        }
        
        .movie-card {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            aspect-ratio: 2/3;
        }
        
        .movie-card:hover {
            transform: scale(1.08) translateY(-8px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
        }
        
        .movie-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.4s ease;
        }
        
        .movie-card:hover img {
            filter: brightness(1.1);
        }
        
        .movie-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            padding: 16px;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }
        
        .movie-card:hover .movie-overlay {
            transform: translateY(0);
        }
        
        .play-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #667eea;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
        }
        
        .movie-card:hover .play-button {
            opacity: 1;
        }
        
        .play-button:hover {
            background: #764ba2;
            transform: translate(-50%, -50%) scale(1.1);
        }
        
        .category-btn {
            padding: 8px 24px;
            border-radius: 25px;
            border: 2px solid #333;
            background: transparent;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 600;
        }
        
        .category-btn:hover,
        .category-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: #1a1a1a;
            border-radius: 16px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid #333;
        }
        
        .rating {
            display: flex;
            gap: 4px;
            font-size: 14px;
        }
        
        .star { color: #ffd700; }
        
        .searchbar {
            position: relative;
        }
        
        .searchbar input {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 25px;
            padding: 10px 20px;
            color: #fff;
            width: 300px;
            transition: all 0.3s ease;
        }
        
        .searchbar input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.15);
        }
        
        .searchbar input::placeholder {
            color: #999;
        }
        
        .watchlist-btn {
            padding: 10px 20px;
            border-radius: 8px;
            background: #667eea;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .watchlist-btn:hover {
            background: #764ba2;
            transform: scale(1.05);
        }
        
        .watchlist-btn.added {
            background: #10b981;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 400px;
        }
        
        .loader {
            border: 4px solid #333;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-black/80 backdrop-blur-md border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="text-3xl">üé¨</div>
                <span class="text-2xl font-bold gradient-text">CinemaHub</span>
            </div>
            
            <div class="searchbar hidden md:block">
                <input type="text" id="searchInput" placeholder="Search movies...">
            </div>
            
            <div class="flex items-center gap-4">
                <button onclick="toggleWatchlist()" class="relative px-4 py-2 rounded-lg hover:bg-gray-800 transition">
                    ‚ù§Ô∏è Watchlist
                    <span id="watchlistBadge" class="absolute -top-2 -right-2 bg-red-600 text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                </button>
                <button onclick="toggleTheme()" class="px-4 py-2 rounded-lg hover:bg-gray-800 transition">
                    üåô
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero relative flex items-end p-8">
        <div class="max-w-xl">
            <h1 id="heroTitle" class="text-5xl font-bold mb-4">Featured Movie</h1>
            <p id="heroDesc" class="text-gray-300 mb-6 line-clamp-3">Loading...</p>
            <div class="flex gap-4">
                <button onclick="playMovie()" class="px-8 py-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg font-bold hover:shadow-lg hover:shadow-purple-500/50 transition">
                    ‚ñ∂ Watch Now
                </button>
                <button onclick="addToWatchlist('hero')" class="px-8 py-3 border-2 border-white rounded-lg font-bold hover:bg-white hover:text-black transition">
                    + Watchlist
                </button>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-12">
        
        <!-- Categories -->
        <div class="mb-12">
            <div class="flex gap-3 overflow-x-auto pb-4">
                <button onclick="filterGenre('all')" class="category-btn active">All Movies</button>
                <button onclick="filterGenre('28')" class="category-btn">Action</button>
                <button onclick="filterGenre('35')" class="category-btn">Comedy</button>
                <button onclick="filterGenre('18')" class="category-btn">Drama</button>
                <button onclick="filterGenre('27')" class="category-btn">Horror</button>
                <button onclick="filterGenre('53')" class="category-btn">Thriller</button>
                <button onclick="filterGenre('878')" class="category-btn">Sci-Fi</button>
                <button onclick="filterGenre('14')" class="category-btn">Fantasy</button>
            </div>
        </div>

        <!-- Trending Section -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold mb-6">Trending Now üî•</h2>
            <div id="trendingMovies" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                <!-- Movies load here -->
            </div>
        </section>

        <!-- Popular Section -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold mb-6">Most Popular ‚≠ê</h2>
            <div id="popularMovies" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                <!-- Movies load here -->
            </div>
        </section>

        <!-- Top Rated Section -->
        <section>
            <h2 class="text-3xl font-bold mb-6">Top Rated üëë</h2>
            <div id="topRatedMovies" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                <!-- Movies load here -->
            </div>
        </section>
    </main>

    <!-- Movie Details Modal -->
    <div id="movieModal" class="modal">
        <div class="modal-content">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-2xl hover:text-red-600 transition">‚úï</button>
            <img id="modalPoster" src="" alt="" class="w-full h-80 object-cover rounded-t-lg">
            <div class="p-8">
                <h2 id="modalTitle" class="text-3xl font-bold mb-2"></h2>
                <div class="flex gap-4 mb-4">
                    <div class="rating" id="modalRating"></div>
                    <span id="modalYear" class="text-gray-400"></span>
                </div>
                <p id="modalDesc" class="text-gray-300 mb-6 leading-relaxed"></p>
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <p class="text-gray-400 text-sm">Rating</p>
                        <p id="modalIMDB" class="text-xl font-bold">8.5/10</p>
                    </div>
                    <div>
                        <p class="text-gray-400 text-sm">Genres</p>
                        <p id="modalGenre" class="text-lg font-semibold">Action, Thriller</p>
                    </div>
                </div>
                <div class="flex gap-4">
                    <button onclick="playMovie()" class="flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg font-bold hover:shadow-lg hover:shadow-purple-500/50 transition">
                        ‚ñ∂ Watch Now
                    </button>
                    <button onclick="addToWatchlist('modal')" class="flex-1 px-6 py-3 border-2 border-white rounded-lg font-bold hover:bg-white hover:text-black transition">
                        + Watchlist
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Watchlist Modal -->
    <div id="watchlistModal" class="modal">
        <div class="modal-content">
            <div class="p-8">
                <h2 class="text-3xl font-bold mb-6">My Watchlist ‚ù§Ô∏è</h2>
                <div id="watchlistItems" class="space-y-4">
                    <p class="text-gray-400 text-center py-8">Your watchlist is empty. Add movies to get started!</p>
                </div>
                <button onclick="toggleWatchlist()" class="mt-6 w-full px-6 py-2 bg-gray-700 rounded-lg font-semibold hover:bg-gray-600 transition">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="fixed bottom-8 right-8 bg-green-600 text-white px-6 py-3 rounded-lg hidden">
        Added to watchlist!
    </div>

    <script>
        const API_KEY = '8ebf7b2d';
        const BASE_URL = 'https://api.themoviedb.org/3';
        const IMG_URL = 'https://image.tmdb.org/t/p/w500';
        
        // Mock movies data (fallback when API fails)
        const mockMovies = [
            {
                id: 1,
                title: "The Shawshank Redemption",
                overview: "Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.",
                poster_path: "https://images.unsplash.com/photo-1489599849228-bed96d3a3c4d?auto=format&fit=crop&q=80&w=500",
                release_date: "1994-10-14",
                vote_average: 9.3,
                genres: [{name: "Drama"}, {name: "Crime"}]
            },
            {
                id: 2,
                title: "The Godfather",
                overview: "The aging patriarch of an organized crime dynasty transfers control of his clandestine empire to his reluctant youngest son.",
                poster_path: "https://images.unsplash.com/photo-1485846234645-a62644f84728?auto=format&fit=crop&q=80&w=500",
                release_date: "1972-03-24",
                vote_average: 9.2,
                genres: [{name: "Crime"}, {name: "Drama"}]
            },
            {
                id: 3,
                title: "The Dark Knight",
                overview: "When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, Batman must accept one of the greatest tests.",
                poster_path: "https://images.unsplash.com/photo-1543722530-d2c3201371e7?auto=format&fit=crop&q=80&w=500",
                release_date: "2008-07-18",
                vote_average: 9.0,
                genres: [{name: "Action"}, {name: "Crime"}]
            },
            {
                id: 4,
                title: "Inception",
                overview: "A thief who steals corporate secrets through the use of dream-sharing technology is given the inverse task of planting an idea.",
                poster_path: "https://images.unsplash.com/photo-1512070679280-1a45f9c16c78?auto=format&fit=crop&q=80&w=500",
                release_date: "2010-07-16",
                vote_average: 8.8,
                genres: [{name: "Sci-Fi"}, {name: "Action"}]
            },
            {
                id: 5,
                title: "Pulp Fiction",
                overview: "The lives of two mob hitmen, a boxer, a gangster's wife, and a pair of diner bandits intertwine in four tales of violence.",
                poster_path: "https://images.unsplash.com/photo-1548010894-a3a4dc0c8fe6?auto=format&fit=crop&q=80&w=500",
                release_date: "1994-10-14",
                vote_average: 8.9,
                genres: [{name: "Crime"}, {name: "Drama"}]
            },
            {
                id: 6,
                title: "Forrest Gump",
                overview: "The presidencies of Kennedy and Johnson, the Vietnam War, the Watergate scandal and other historical events unfold from the perspective of an Alabama man.",
                poster_path: "https://images.unsplash.com/photo-1574235211450-eed266df24cd?auto=format&fit=crop&q=80&w=500",
                release_date: "1994-07-06",
                vote_average: 8.8,
                genres: [{name: "Drama"}, {name: "Romance"}]
            },
            {
                id: 7,
                title: "Interstellar",
                overview: "A team of explorers travel through a wormhole in space in an attempt to ensure humanity's survival.",
                poster_path: "https://images.unsplash.com/photo-1536440936694-6c676bccc92e?auto=format&fit=crop&q=80&w=500",
                release_date: "2014-11-07",
                vote_average: 8.7,
                genres: [{name: "Sci-Fi"}, {name: "Drama"}]
            },
            {
                id: 8,
                title: "The Matrix",
                overview: "A computer hacker learns from mysterious rebels about the true nature of his reality and his role in the war against its controllers.",
                poster_path: "https://images.unsplash.com/photo-1535016066054-ad025b65f5a3?auto=format&fit=crop&q=80&w=500",
                release_date: "1999-03-31",
                vote_average: 8.7,
                genres: [{name: "Sci-Fi"}, {name: "Action"}]
            },
            {
                id: 9,
                title: "Avatar",
                overview: "A paraplegic Marine dispatched to the moon Pandora on a unique mission becomes torn between following his orders and protecting the world he feels is his home.",
                poster_path: "https://images.unsplash.com/photo-1598899217893-4c5b8aa87ebc?auto=format&fit=crop&q=80&w=500",
                release_date: "2009-12-18",
                vote_average: 7.8,
                genres: [{name: "Sci-Fi"}, {name: "Fantasy"}]
            },
            {
                id: 10,
                title: "Titanic",
                overview: "A seventeen-year-old aristocrat falls in love with a kind but poor artist aboard the luxurious, ill-fated R.M.S. Titanic.",
                poster_path: "https://images.unsplash.com/photo-1561988703-137c0343e2fb?auto=format&fit=crop&q=80&w=500",
                release_date: "1997-12-19",
                vote_average: 7.8,
                genres: [{name: "Drama"}, {name: "Romance"}]
            },
            {
                id: 11,
                title: "Joker",
                overview: "In Gotham City, struggling comedian Arthur Fleck is disregarded and mistreated by society. He then embarks on a downward spiral of revolution and bloody crime.",
                poster_path: "https://images.unsplash.com/photo-1618945824727-92b8c258401e?auto=format&fit=crop&q=80&w=500",
                release_date: "2019-10-04",
                vote_average: 8.4,
                genres: [{name: "Crime"}, {name: "Drama"}]
            },
            {
                id: 12,
                title: "Avengers Endgame",
                overview: "After the devastating events, the Avengers assemble once more in order to reverse Thanos' actions and restore balance.",
                poster_path: "https://images.unsplash.com/photo-1578874691223-64558c0e33ad?auto=format&fit=crop&q=80&w=500",
                release_date: "2019-04-26",
                vote_average: 8.4,
                genres: [{name: "Action"}, {name: "Adventure"}]
            }
        ];
        
        let watchlist = JSON.parse(localStorage.getItem('watchlist')) || [];
        let currentGenre = 'all';
        let currentModal = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadTrendingMovies();
            loadPopularMovies();
            loadTopRatedMovies();
            updateWatchlistBadge();
            setupSearch();
        });

        // Fetch trending movies
        async function loadTrendingMovies() {
            try {
                const response = await fetch(`${BASE_URL}/trending/movie/week?api_key=${API_KEY}`);
                const data = await response.json();
                if (data.results && data.results.length > 0) {
                    displayMovies(data.results.slice(0, 20), 'trendingMovies');
                    const hero = data.results[0];
                    document.getElementById('heroTitle').textContent = hero.title;
                    document.getElementById('heroDesc').textContent = hero.overview;
                } else {
                    loadMockTrending();
                }
            } catch (error) {
                console.log('API Error, using mock data');
                loadMockTrending();
            }
        }

        // Load mock trending
        function loadMockTrending() {
            displayMovies(mockMovies, 'trendingMovies');
            document.getElementById('heroTitle').textContent = mockMovies[0].title;
            document.getElementById('heroDesc').textContent = mockMovies[0].overview;
        }

        // Fetch popular movies
        async function loadPopularMovies() {
            try {
                const response = await fetch(`${BASE_URL}/movie/popular?api_key=${API_KEY}`);
                const data = await response.json();
                if (data.results && data.results.length > 0) {
                    displayMovies(data.results.slice(0, 20), 'popularMovies');
                } else {
                    displayMovies(mockMovies.slice(0, 10), 'popularMovies');
                }
            } catch (error) {
                displayMovies(mockMovies.slice(0, 10), 'popularMovies');
            }
        }

        // Fetch top rated movies
        async function loadTopRatedMovies() {
            try {
                const response = await fetch(`${BASE_URL}/movie/top_rated?api_key=${API_KEY}`);
                const data = await response.json();
                if (data.results && data.results.length > 0) {
                    displayMovies(data.results.slice(0, 20), 'topRatedMovies');
                } else {
                    displayMovies(mockMovies.slice(10, 20), 'topRatedMovies');
                }
            } catch (error) {
                displayMovies(mockMovies.slice(10, 20), 'topRatedMovies');
            }
        }

        // Display movies
        function displayMovies(movies, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = movies.map(movie => {
                const posterUrl = movie.poster_path ? 
                    (movie.poster_path.startsWith('http') ? movie.poster_path : IMG_URL + movie.poster_path) : 
                    movie.poster_path;
                return `
                <div class="movie-card" onclick="openMovieDetail(${movie.id})">
                    <img src="${posterUrl}" alt="${movie.title}" onerror="this.src='https://via.placeholder.com/300x450?text=${movie.title}'">
                    <div class="play-button">‚ñ∂</div>
                    <div class="movie-overlay">
                        <h3 class="font-bold text-sm line-clamp-2">${movie.title}</h3>
                        <div class="flex gap-2 mt-2 text-xs text-gray-300">
                            <span>‚≠ê ${(movie.vote_average || 0).toFixed(1)}</span>
                            <span>${movie.release_date ? new Date(movie.release_date).getFullYear() : 'N/A'}</span>
                        </div>
                    </div>
                </div>
            `;
            }).join('');
        }

        // Open movie details
        async function openMovieDetail(movieId) {
            try {
                let movie;
                // Check if it's a mock movie
                const mockMovie = mockMovies.find(m => m.id === movieId);
                if (mockMovie) {
                    movie = mockMovie;
                } else {
                    const response = await fetch(`${BASE_URL}/movie/${movieId}?api_key=${API_KEY}`);
                    movie = await response.json();
                }
                
                const posterUrl = movie.poster_path ? 
                    (movie.poster_path.startsWith('http') ? movie.poster_path : IMG_URL + movie.poster_path) : 
                    '';
                
                document.getElementById('modalPoster').src = posterUrl;
                document.getElementById('modalTitle').textContent = movie.title;
                document.getElementById('modalDesc').textContent = movie.overview || 'No description available';
                document.getElementById('modalYear').textContent = movie.release_date ? new Date(movie.release_date).getFullYear() : 'N/A';
                document.getElementById('modalIMDB').textContent = (movie.vote_average || 0).toFixed(1) + '/10';
                
                const genreText = movie.genres && movie.genres.length > 0 ? 
                    movie.genres.map(g => g.name || g).join(', ') : 'N/A';
                document.getElementById('modalGenre').textContent = genreText;
                
                // Star rating
                const stars = Math.round((movie.vote_average || 0) / 2);
                document.getElementById('modalRating').innerHTML = '‚≠ê'.repeat(Math.min(stars, 5)) + '‚òÜ'.repeat(Math.max(0, 5 - stars));
                
                currentModal = movieId;
                document.getElementById('movieModal').classList.add('active');
            } catch (error) {
                console.log('Error loading movie details', error);
                alert('Error loading movie details');
            }
        }

        // Close modal
        function closeModal() {
            document.getElementById('movieModal').classList.remove('active');
            currentModal = null;
        }

        // Add to watchlist
        function addToWatchlist(source) {
            if (!currentModal && source === 'modal') return;
            
            const movieId = currentModal;
            if (!watchlist.includes(movieId)) {
                watchlist.push(movieId);
                localStorage.setItem('watchlist', JSON.stringify(watchlist));
                updateWatchlistBadge();
                showNotification('Added to watchlist!');
            }
        }

        // Toggle watchlist modal
        function toggleWatchlist() {
            const modal = document.getElementById('watchlistModal');
            if (modal.classList.contains('active')) {
                modal.classList.remove('active');
            } else {
                displayWatchlist();
                modal.classList.add('active');
            }
        }

        // Display watchlist
        async function displayWatchlist() {
            const container = document.getElementById('watchlistItems');
            
            if (watchlist.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-8">Your watchlist is empty!</p>';
                return;
            }
            
            let html = '';
            for (const movieId of watchlist) {
                try {
                    const response = await fetch(`${BASE_URL}/movie/${movieId}?api_key=${API_KEY}`);
                    const movie = await response.json();
                    html += `
                        <div class="flex gap-4 p-4 bg-gray-800 rounded-lg">
                            <img src="${IMG_URL}${movie.poster_path}" alt="${movie.title}" class="w-20 h-32 object-cover rounded">
                            <div class="flex-1">
                                <h3 class="font-bold text-lg">${movie.title}</h3>
                                <p class="text-gray-400 text-sm mb-2">${movie.release_date}</p>
                                <p class="text-gray-300 text-sm line-clamp-2">${movie.overview}</p>
                                <div class="flex gap-2 mt-3">
                                    <button onclick="playMovie()" class="px-4 py-1 bg-purple-600 rounded text-sm font-semibold hover:bg-purple-700">
                                        Watch
                                    </button>
                                    <button onclick="removeFromWatchlist(${movieId})" class="px-4 py-1 bg-red-600 rounded text-sm font-semibold hover:bg-red-700">
                                        Remove
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                } catch (error) {
                    console.log('Error loading watchlist item');
                }
            }
            container.innerHTML = html;
        }

        // Remove from watchlist
        function removeFromWatchlist(movieId) {
            watchlist = watchlist.filter(id => id !== movieId);
            localStorage.setItem('watchlist', JSON.stringify(watchlist));
            updateWatchlistBadge();
            displayWatchlist();
            showNotification('Removed from watchlist');
        }

        // Update watchlist badge
        function updateWatchlistBadge() {
            const badge = document.getElementById('watchlistBadge');
            if (watchlist.length > 0) {
                badge.textContent = watchlist.length;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // Filter by genre
        async function filterGenre(genreId) {
            currentGenre = genreId;
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (genreId === 'all') {
                loadTrendingMovies();
                loadPopularMovies();
                loadTopRatedMovies();
            } else {
                try {
                    const response = await fetch(`${BASE_URL}/discover/movie?api_key=${API_KEY}&with_genres=${genreId}`);
                    const data = await response.json();
                    displayMovies(data.results.slice(0, 20), 'trendingMovies');
                    document.getElementById('popularMovies').innerHTML = '';
                    document.getElementById('topRatedMovies').innerHTML = '';
                } catch (error) {
                    console.log('Error filtering by genre');
                }
            }
        }

        // Search movies
        function setupSearch() {
            document.getElementById('searchInput').addEventListener('input', async (e) => {
                const query = e.target.value.trim();
                if (query.length < 2) return;
                
                try {
                    const response = await fetch(`${BASE_URL}/search/movie?api_key=${API_KEY}&query=${query}`);
                    const data = await response.json();
                    displayMovies(data.results.slice(0, 20), 'trendingMovies');
                } catch (error) {
                    console.log('Error searching movies');
                }
            });
        }

        // Play movie
        function playMovie() {
            showNotification('Opening player...');
            setTimeout(() => {
                alert('üé¨ Player Opening...\n\nNote: This is a demo. In a real app, this would open a video player.\n\nEnjoy your movie!');
            }, 1500);
        }

        // Show notification
        function showNotification(message) {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.classList.remove('hidden');
            setTimeout(() => {
                notif.classList.add('hidden');
            }, 2000);
        }

        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
        }
    </script>

</body>
</html>
